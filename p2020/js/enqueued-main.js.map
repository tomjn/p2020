{"version":3,"sources":["init.js","mobile-menu.js","dynamic-new-post-editor.js","fixed-toolbar.js","mobile-new-post.js","subscribe-to-comments.js","polyfills-nonblocking.js","unfiltered-home.js"],"names":["$","hasClass","addClass","jQuery","moveNavIntoSidebar","$menu","length","parents","prependTo","wrap","moveNavOutOfSidebar","appendTo","remove","document","ready","click","toggleClass","enquire","register","match","unmatch","editor","querySelector","$editorFooter","newPostContentKey","window","_currentSiteId","isEditorEmpty","editorContent","localStorage","getItem","shouldShowEditorFooter","contains","activeElement","handleFocusChange","show","hide","addEventListener","enableFixedToolbarByDefault","rawSettings","settings","JSON","parse","fixedToolbar","undefined","setItem","stringify","$editor","$controls","btnNew","find","btnCancel","before","css","slideDown","slideUp","subscribeToCommentsOnNewPostsByDefault","prop","getScript","Modernizr","focuswithin","location","pathname","search"],"mappings":"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","file":"enqueued-main.js","sourcesContent":["( function( $ ) {\n\t// Only do this once\n\tif ( $( 'body' ).hasClass( 'p2020-js-loaded' ) ) {\n\t\treturn;\n\t}\n\n\t$( 'body' ).addClass( 'p2020-js-loaded' );\n} )( jQuery );\n","// TODO: Test and clean up for P2020\n\n( function( $ ) {\n\tfunction moveNavIntoSidebar() {\n\t\tconst $menu = $( 'nav#site-navigation' );\n\t\tif ( $menu.length && $menu.parents( 'header#masthead' ).length ) {\n\t\t\t$menu.prependTo( '#sidebar' );\n\t\t\t$menu.wrap(\n\t\t\t\t'<aside class=\"widget\" id=\"o2-responsive-nav\"></aside>'\n\t\t\t);\n\t\t}\n\t}\n\n\tfunction moveNavOutOfSidebar() {\n\t\tconst $menu = $( 'nav#site-navigation' );\n\t\tif ( $menu.length && 0 === $menu.parents( 'header#masthead' ).length ) {\n\t\t\t$( 'nav#site-navigation' ).appendTo( 'header#masthead' );\n\t\t\t$( '#o2-responsive-nav' ).remove();\n\t\t}\n\t}\n\n\t$( document ).ready( function() {\n\t\t$( '[data-mobile-menu-toggle]' ).click( function() {\n\t\t\t$( 'body' ).toggleClass( 'mobile-menu-is-visible' );\n\t\t} );\n\n\t\tif ( 'undefined' !== typeof enquire ) {\n\t\t\t// \"Tablet\" max-width also defined in css/src/global/_variables.scss\n\t\t\tenquire.register( 'screen and (max-width:876px)', {\n\t\t\t\tmatch() {\n\t\t\t\t\tmoveNavIntoSidebar();\n\t\t\t\t},\n\n\t\t\t\tunmatch() {\n\t\t\t\t\tmoveNavOutOfSidebar();\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\t} );\n} )( jQuery );\n","/**\n * Only show the editor footer when the editor is active or has content.\n */\n( function( $ ) {\n\t$( document ).ready( () => {\n\t\t/**\n\t\t * Selectors\n\t\t */\n\t\tconst editor = document.querySelector( '.o2-app-new-post' );\n\t\tif ( editor === null ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $editorFooter = $( '.o2-app-new-post .o2-editor-footer' );\n\n\t\t/**\n\t\t * Local Storage Keys\n\t\t */\n\t\tconst newPostContentKey = `${ window._currentSiteId }-new`;\n\n\t\t/**\n\t\t * Functions\n\t\t */\n\t\tconst isEditorEmpty = () => {\n\t\t\tconst editorContent = window.localStorage.getItem(\n\t\t\t\tnewPostContentKey\n\t\t\t);\n\t\t\treturn editorContent === '';\n\t\t};\n\n\t\tconst shouldShowEditorFooter = () =>\n\t\t\teditor.contains( document.activeElement ) || ! isEditorEmpty();\n\n\t\tconst handleFocusChange = () => {\n\t\t\tif ( shouldShowEditorFooter() ) {\n\t\t\t\t$editorFooter.show();\n\t\t\t} else {\n\t\t\t\t$editorFooter.hide();\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Main\n\t\t */\n\t\tif ( isEditorEmpty() ) {\n\t\t\t$editorFooter.hide();\n\t\t}\n\n\t\tif ( editor ) {\n\t\t\teditor.addEventListener( 'focus', handleFocusChange, true );\n\t\t\teditor.addEventListener( 'blur', handleFocusChange, true );\n\t\t}\n\t} );\n} )( jQuery );\n","( function() {\n\t// Enable the fixed toolbar feature if not explicitly disabled\n\tfunction enableFixedToolbarByDefault() {\n\t\tconst rawSettings = window.localStorage.getItem( 'p2tenberg_features' );\n\t\tconst settings = rawSettings ? JSON.parse( rawSettings ) : {};\n\n\t\tif ( settings.fixedToolbar === undefined ) {\n\t\t\twindow.localStorage.setItem(\n\t\t\t\t'p2tenberg_features',\n\t\t\t\tJSON.stringify( {\n\t\t\t\t\t...settings,\n\t\t\t\t\tfixedToolbar: true,\n\t\t\t\t} )\n\t\t\t);\n\t\t}\n\t}\n\n\t// No need to wait for document ready\n\tenableFixedToolbarByDefault();\n} )();\n","( function( $ ) {\n\t$( document ).ready( () => {\n\t\tconst $editor = $( '.o2-app-new-post' );\n\t\tconst $controls = $( '[data-p2020-mobile-new-post-controls]' );\n\t\tconst btnNew = $controls.find( 'button' )[ 0 ];\n\t\tconst btnCancel = $controls.find( 'button' )[ 1 ];\n\n\t\t// When user is not logged in\n\t\tif ( $editor.length === 0 ) {\n\t\t\t$controls.hide();\n\t\t\treturn;\n\t\t}\n\n\t\t$editor.before( $controls );\n\t\t$controls.css( 'visibility', 'visible' ); // prevents FOUC before the DOM manipulation\n\n\t\tbtnNew.addEventListener( 'click', () => {\n\t\t\t$editor.slideDown( 'fast' );\n\t\t\t$( btnNew ).hide();\n\t\t\t$( btnCancel ).show();\n\t\t} );\n\n\t\tbtnCancel.addEventListener( 'click', () => {\n\t\t\t$editor.slideUp( 'fast' );\n\t\t\t$( btnCancel ).hide();\n\t\t\t$( btnNew ).show();\n\t\t} );\n\t} );\n} )( jQuery );\n","( function( $ ) {\n\t// Enable \"Notify me of new comments via email\" on new posts by default and hide the form\n\tfunction subscribeToCommentsOnNewPostsByDefault() {\n\t\t$( 'input[type=\"checkbox\"]#post_subscribe' ).prop( 'checked', true );\n\t\t$( '.o2-post-form-options' ).hide();\n\t}\n\n\t$( document ).ready( () => {\n\t\tsubscribeToCommentsOnNewPostsByDefault();\n\t} );\n} )( jQuery );\n","// Polyfills for things that don't need to block the rest of the JS\n\n( function( $ ) {\n\t$( document ).ready( () => {\n\t\t// CSS :focus-visible\n\t\t$.getScript( 'https://unpkg.com/focus-visible' );\n\n\t\t// CSS :focus-within\n\t\tif ( ! Modernizr.focuswithin ) {\n\t\t\t$.getScript( 'https://unpkg.com/focus-within-polyfill' );\n\t\t}\n\t} );\n} )( jQuery );\n","( function( $ ) {\n\t$( document ).ready( function() {\n\t\t// Is home page and not displaying O2 filtered content\n\t\tif (\n\t\t\twindow.location.pathname === '/' &&\n\t\t\twindow.location.search === ''\n\t\t) {\n\t\t\t$( '.o2-app-page-title' ).addClass( 'is-unfiltered-home' );\n\t\t}\n\t} );\n} )( jQuery );\n"]}